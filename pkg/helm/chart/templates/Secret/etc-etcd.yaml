apiVersion: v1
kind: Secret
metadata:
  name: etc-etcd
  annotations:
    helm.sh/hook: pre-install,pre-upgrade
    helm.sh/hook-delete-policy: before-hook-creation
data:
  ca.crt: {{ .Values.EtcdCaCert }}
  server.crt: {{ .Values.EtcdServerCert }}
  server.key: {{ .Values.EtcdServerKey }}
  peer.crt: {{ .Values.EtcdPeerCert }}
  peer.key: {{ .Values.EtcdPeerKey }}
stringData:
  etcd.conf: |
    ETCD_ADVERTISE_CLIENT_URLS=https://master-etcd:2379
    ETCD_CERT_FILE=/etc/etcd/server.crt
    ETCD_CLIENT_CERT_AUTH="true"
    ETCD_DATA_DIR=/var/lib/etcd/
    ETCD_ELECTION_TIMEOUT=2500
    ETCD_HEARTBEAT_INTERVAL=500
    ETCD_INITIAL_ADVERTISE_PEER_URLS=https://master-etcd:2380
    ETCD_INITIAL_CLUSTER=default=https://master-etcd:2380
    ETCD_KEY_FILE=/etc/etcd/server.key
    ETCD_LISTEN_CLIENT_URLS=https://0.0.0.0:2379
    ETCD_LISTEN_PEER_URLS=https://0.0.0.0:2380
    ETCD_PEER_CERT_FILE=/etc/etcd/peer.crt
    ETCD_PEER_CLIENT_CERT_AUTH="true"
    ETCD_PEER_KEY_FILE=/etc/etcd/peer.key
    ETCD_PEER_TRUSTED_CA_FILE=/etc/etcd/ca.crt
    ETCD_QUOTA_BACKEND_BYTES=4294967296
    ETCD_TRUSTED_CA_FILE=/etc/etcd/ca.crt
